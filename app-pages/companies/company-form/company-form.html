<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css">
<link rel="icon" type="image/x-icon" href="../../favicon.ico">
<link rel="stylesheet" href="company-form.css">
<link rel="stylesheet" href="../../footer.css">
<link rel="stylesheet" href="../../header.css">
<link rel="stylesheet" href="../../sidebar.css">
<body>
    <header>
        <div class="col-12 container-fluid">
            <nav class="header-box py-3 d-flex justify-content-flex-start gap-3">
                <a href="../../index.html">
                    <i class="fas fa-home fa-2x"></i>
                </a>
                <a href="">
                    <i class="fas fa-user fa-2x"></i>
                </a>
                <a href="" class="signOut flex-grow-1 text-end">
                    <i class="fas fa fa-sign-out fa-2x"></i>
                </a>
            </nav>
        </div>
    </header>

    <main>
        <aside [id]="isActive">
            <button class="buttonMenu" type="button" (click)="handleMenu($event)"><i class="fas fa-solid fa-bars fa-2x" style="color: #D1972C;"></i></button>
        
            <div class="col-12 col-sm-6 col-md-6 col-lg-2 col-xl-2 container-sidebar d-flex flex-column justify-content-sm-between sidebar">
                <nav class="sidebar_nav">
                    <ul class="list-unstyled px-10">
                        <li>
                            <a href="../companies-list/companies-list.html" class="text-decoration-none px-3 py-2 d-block">
                                <i class="far fa-folder fa-2x"></i>
                                <font size="5">Empresas</font>
                            </a>
                        </li>
                        <li>
                            <a href="/" class="text-decoration-none px-3 py-2 d-block">
                                <i class="far fa-folder fa-2x"></i>
                                <font size="5">Nova Empresa</font>
                            </a>
                        </li>
                        <li>
                            <a href="/" class="text-decoration-none px-3 py-2 d-block">
                                <i class="fas fa-users fa-2x"></i>
                                <font size="5">Usuários</font>
                            </a>
                        </li>
                        <li>
                            <a href="/" class="text-decoration-none px-3 py-2 d-block">
                                <i class="fas fa-users fa-2x"></i>
                                <font size="5">Novo Usuário</font>
                            </a>
                        </li>
                    </ul>
                </nav>
        
                <figure class="mb-1 sidebar__logo text-center">
                    <img class="w-100" src="../../../assets/resources/images/logo.svg" alt="Contabilist logo">
                </figure>
            </div>
        </aside>
        <div class="container-fluid">
            <form id="company-form" onsubmit="handleFormSubmit(event)" class="offset-lg-2 offset-xl-2">
                <div class="form-container">
                    <span class="form-message">Campos marcados com asterísco são obrigatórios. (*)</span>

                    <div class="row">
                        <div class="col-8">
                            <label for="businessName">
                                <p>Razão Social *</p>
                                <input
                                    formControlName="businessName"
                                    type="text"
                                    name="businessName"
                                    id="businessName"
                                    placeholder="Sport Clube Corinthians"
                                    required
                                    minlength="3"
                                    autofocus  
                                >
                                <span class="error-message" id="businessName-error" style="color: red;"></span>
                            </label>
                        </div>


                        <div class="col-4">
                            <label for="status">
                                <p>Ativa? *</p>
                                <select formControlName="status" name="status" id="status" required>
                                    <option value="true">Sim</option>
                                    <option value="false">Não</option>
                                </select>

                            </label>
                            
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12">
                            <label for="name">
                                <p>Nome Fantasia *</p>
                                <input
                                    formControlName="name"
                                    type="text"
                                    name="name"
                                    id="name"
                                    placeholder="Corinthians"
                                    required
                                    minlength="3"
                                >
                                <span class="error-message" id="businessName-error" style="color: red;"></span>
                            </label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12 col-xl-4 col-lg-4">
                            <label for="cnpj">
                                <p>CNPJ *</p>
                                <input
                                    formControlName="cnpj"
                                    type="text"
                                    name="cnpj"
                                    id="cnpj"
                                    placeholder="00.000.000/0000-00"
                                    required
                                    minlength="18"
                                    maxlength="18"
                                >
                            </label>
                        </div>

                        <div class="col-8 col-xl-4 col-lg-4">
                            <label for="email">
                                <p>Endereço de E-mail *</p>
                                <input
                                    formControlName="email"
                                    type="email"
                                    name="email"
                                    id="email"
                                    placeholder="corinthians@gmail.com"
                                    required
                                    minlength="5"
                                    pattern="^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})?$"
                                >
                            </label>
                        </div>
                        <div class="col-4">
                            <label for="phone">
                                <p>Telefone *</p>
                                <input
                                    formControlName="phone"
                                    type="tel"
                                    name="phone"
                                    id="phone"
                                    placeholder="(11) 9 9999-9999"
                                    required
                                    minlength="16"
                                    maxlength="16"
                                >
                            </label>
                        </div>
                        
                    </div>
                    
                    <div class="row">
                        <div class="col-lg-4 col-xl-4">
                            <label for="cep">
                                <p>CEP *</p>
                                <input
                                    formControlName="cep"
                                    type="text"
                                    name="cep"
                                    id="cep"
                                    placeholder="80000-000"
                                    required
                                    onblur="pesquisacep(this.value);"
                                    value="" 
                                    size="10" 
                                    maxlength="9"
                                >
                            </label>
                        </div>
                        <div class="col-lg-4 col-xl-4">
                            <label for="city">
                                <p>Cidade *</p>
                                <input type="text" name="city" id="city" formControlName="city" placeholder="São Paulo" required>
                            </label>
                        </div>
                        <div class="col-lg-4 col-xl-4">
                            <label for="state">
                                <p>Estado *</p>
                                <input type="text" name="state" id="state" formControlName="state" placeholder="São Paulo" required>
                            </label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-6">
                            <div class="goBackButton defaultButton">
                                <button type="button" onclick="clearForm()">Limpar</button>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="submitButton defaultButton">
                                <button type="submit">Adicionar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <div id="success-message-container">
                Formulário Enviado com Sucesso!
            </div>
        </div>
    </main>
    <footer>
        <div class="container-fluid">
            <div class="row border-top offset-lg-2 offset-xl-2">
                <div class="col-6 text-center">
                    <p>Usuário: <strong>Gustavo Schneider</strong></p>
                </div>
                <div class="col-6 text-center">
                    <p>Office: <strong>Schneider Serviços Contábeis</strong></p>
                </div>
            </div>
        </div>
    </footer>
    <script>
    
        function limpa_formulário_cep() {
                //Limpa valores do formulário de cep.
                document.getElementById('state').value=("");
                document.getElementById('city').value=("");
        }
    
        function meu_callback(conteudo) {
            if (!("erro" in conteudo)) {
                //Atualiza os campos com os valores.
                document.getElementById('state').value=(conteudo.uf);
                document.getElementById('city').value=(conteudo.localidade);
            } //end if.
            else {
                //CEP não Encontrado.
                limpa_formulário_cep();
                alert("CEP não encontrado.");
            }
        }
            
        function pesquisacep(valor) {
    
            //Nova variável "cep" somente com dígitos.
            var cep = valor.replace(/\D/g, '');
    
            //Verifica se campo cep possui valor informado.
            if (cep != "") {
    
                //Expressão regular para validar o CEP.
                var validacep = /^[0-9]{8}$/;
    
                //Valida o formato do CEP.
                if(validacep.test(cep)) {
    
                    //Preenche os campos com "..." enquanto consulta webservice.
                    document.getElementById('state').value="...";
                    document.getElementById('city').value="...";
    
                    //Cria um elemento javascript.
                    var script = document.createElement('script');
    
                    //Sincroniza com o callback.
                    script.src = 'https://viacep.com.br/ws/'+ cep + '/json/?callback=meu_callback';
    
                    //Insere script no documento e carrega o conteúdo.
                    document.body.appendChild(script);
    
                } //end if.
                else {
                    //cep é inválido.
                    limpa_formulário_cep();
                    alert("Formato de CEP inválido.");
                }
            } //end if.
            else {
                //cep sem valor, limpa formulário.
                limpa_formulário_cep();
            }
        };
    
        </script>
    <script src="company-form.js"></script>
</body>
</html>